# Lessons Learned

- 2026-02-23: When the user specifies a workflow doc as the first step each turn, surface it at the top of primary AI guides and remove legacy instruction files to avoid conflicting guidance.
- 2026-02-23: When the workflow is updated, replace prior workflow text and rebase plans to follow the new session ritual and plan verification steps.
- 2026-02-23: Never trust a conversation summary's claim that source data is "already normalized." Always run a direct check (grep or python) on the actual file before planning. The summary said Applications.yaml was correct; it was not.
- 2026-02-23: Do not patch the export pipeline to compensate for incorrect source data. Fix the source data first, then re-export. Patching exporters mid-investigation before understanding the full picture caused an incorrect fix that had to be reverted.
- 2026-02-23: After modifying source data and re-exporting, always check for stale frontmatter files from the old naming convention. The re-export created new files but left the old ones in place — both sets existed until explicitly deleted.
- 2026-02-24: Node.js `http.get(url, { timeout })` only fires the 'timeout' event but does NOT abort the request. Always use `req.setTimeout(ms, cb)` with a callback that calls `req.destroy()` to actually cancel the request. Pre-existing validation scripts used the inert form and hung indefinitely in postdeploy.
- 2026-02-24: `generateBreadcrumbs()` required an explicit `breadcrumb:` array in frontmatter. 26 material pages were never exported with that field. Fix: auto-derive from `fullPath` (always present) when the explicit array is absent. Must fix at the code layer, not by patching 26 YAML files directly → rule: fix at source (Layer 2 code fix, not Layer 1 data patch).
- 2026-02-24: `chrome-launcher` does not auto-discover Chrome on macOS when Chrome is not in PATH. Performance validation scripts silently fail or hang. Fix at the runner level: auto-set `CHROME_PATH` when the macOS standard path is present. Do not hardcode in individual scripts.

- 2026-02-24: Generator field name mismatch (`breadcrumbs` written, `breadcrumb` read) caused silent export failures — field was absent from all generated output. Rule: always grep the consuming TypeScript type for the exact field name before naming a new generator output field.
- 2026-02-24: Grepping thin Next.js route-delegate files ([slug]/page.tsx) for schema injection returns false negatives — those files only re-export from a shared factory. Always trace through to the rendering layer (ItemPage.tsx, createContentPage.tsx) before concluding schema coverage is missing.
