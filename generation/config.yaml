# Generation Configuration
# Quality-gated generation with automatic retry and parameter adjustment

# Quality Gate Settings
# CRITICAL: Thresholds are LEARNED dynamically from database (ThresholdManager)
# These fallback values are ONLY used when insufficient learning data (<10 samples)
quality_gates:
  realism_threshold_fallback: 3.0        # PRODUCTION MODE: Accept good-enough content (was 4.0)
  max_retry_attempts: 5                  # Maximum generation attempts before failure
  voice_authenticity_threshold_fallback: 3.0  # PRODUCTION MODE: Accept good-enough content (was 4.0)
  tonal_consistency_threshold_fallback: 3.0   # PRODUCTION MODE: Accept good-enough content (was 4.0)
  winston_threshold_fallback: 0.70       # PRODUCTION MODE: 70% AI allowed (was 0.50)
  require_zero_ai_tendencies: false      # RELAXED: Allow AI patterns
  adaptive_threshold: true               # Learn from 75th percentile of successful content

# Evaluation Settings
evaluation:
  temperature: 0.2                       # Low temperature for consistent evaluation
  model: "grok-beta"                     # Evaluation model (Grok for subjective)
  verbose: true                          # Print detailed evaluation output

# Base Voice Parameters (Before Learning/Adjustment)
# These are the starting baseline - RealismOptimizer adjusts during retry
voice_parameters:
  emotional_tone: 0.3                    # Base: moderate emotion (0.0-1.0)
  opinion_rate: 0.2                      # Base: low opinion frequency (0.0-1.0)
  structural_predictability: 0.5         # Base: moderate structure (0.0-1.0)
  sentence_rhythm_variation: 1.0         # Base: maximum variation (0.0-1.0) - triggers 'varied' rhythm pattern
  imperfection_tolerance: 0.4            # Base: moderate imperfections (0.0-1.0)
  trait_frequency: 0.5                   # Base: moderate personality (0.0-1.0)
  colloquialism_frequency: 0.3           # Base: low casual language (0.0-1.0)
  technical_intensity: 2                 # Base: moderate technical detail (1-3 scale)

# Simple Mode Configuration (Legacy - Deprecated)
# Use quality_gates instead for production
simple_mode:
  enabled: false                         # DISABLED: Using quality-gated generation
  fixed_temperature: 0.9                 # Fixed temperature (proven to work)
  max_attempts: 1                        # Single-pass generation (no retries in generation phase)
  temperature_increase_per_retry: 0.0    # N/A - no retries in generation phase

# Length Variation Control (1-10 scale)
# This SINGLE slider controls variation for ALL components
# Calculation: variation_pct = 10% + (slider * 5%)
# Examples:
#   1 = ±15% (target 100 → range 85-115)
#   5 = ±35% (target 100 → range 65-135) 
#   10 = ±60% (target 100 → range 40-160)
length_variation_range: 10               # Maximum variation: ±60%

# Word Count Variation for Structural Diversity (0.0-1.0 scale)
# Applied in prompt_builder.py to create ranges instead of exact targets
# Used by structural_variation_checker.py to validate batch diversity
# Calculation: range = target ± (target * word_count_variation)
# Examples:
#   0.05 = ±5% (target 100 → range 95-105)
#   0.10 = ±10% (target 100 → range 90-110)
#   0.20 = ±20% (target 100 → range 80-120)
# Recommended: 0.10 (±10%) - supports ≥5% variance requirement
word_count_variation: 0.50               # ±50% variation for maximum diversity
  
# Winston Feedback Database
winston_feedback_db_path: "z-beam.db"    # SQLite database for Winston feedback

# Component Lengths (word count targets ONLY)
# Global length_variation_range applies uniformly to all components
# min/max calculated dynamically: target ± (target * variation_pct)
component_lengths:
  caption:
    target: 75                         # Target word count (variation applied from global slider)
    extraction_strategy: before_after  # Extract before/after sections
  
  subtitle:
    target: 25                         # Target word count (variation applied from global slider)
    extraction_strategy: raw           # Return text as-is
  
  faq:
    target: 150                        # Target word count (variation applied from global slider)
    extraction_strategy: json_list     # Parse JSON array
  
  description:
    target: 80                         # Target word count (increased for Winston 300 char minimum)
    extraction_strategy: raw           # Return text as-is

# What gets disabled in simple mode:
disabled_features:
  - temperature_advisor                  # No dynamic temperature learning
  - pattern_learner                      # No risky pattern detection
  - prompt_optimizer                     # No prompt enhancement
  - weight_learner                       # No composite weight learning
  - fix_strategy_manager                 # No adaptive fix strategies
  - success_predictor                    # No success prediction
  - stuck_pattern_detection              # No stuck pattern fresh regen
  
# What stays enabled:
enabled_features:
  - winston_detection                    # Winston AI quality check
  - realism_evaluation                   # Realism scoring
  - readability_check                    # Readability validation
  - subjective_validation                # Subjective language check
  - database_logging                     # Log results for later analysis
