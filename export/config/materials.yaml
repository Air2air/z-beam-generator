# Materials Domain Export Configuration
# Cross-references: domains/materials/config.yaml (generation settings)
# Schema: export/config/schema.yaml

domain: materials
source_file: data/materials/Materials.yaml
output_path: ../z-beam/frontmatter/materials
items_key: materials
filename_suffix: ''
relationship_groups:
  technical:
  - contaminated_by
  safety:
  - regulatory_standards
  operational:
  - industry_applications
id_field: id
generators:
# Core Principle 0.6 Compliance (Jan 7, 2026): ✅ COMPLETE
# ALL data complete in source - export adds ONLY export-time fields
# Phase 1 (Jan 6): Backfilled all 438 items with fullPath, breadcrumb, metaDescription
# Phase 2 (Jan 7): Generation layer adds metadata to NEW items via enrich_on_save()
# Phase 3 (Jan 7): Export adds ONLY: dateModified (timestamp), pageTitle (if missing)
- type: universal_content
  module: export.generation.universal_content_generator
  class: UniversalContentGenerator
  tasks:
  # Phase 1: Remove Duplicate/Legacy Fields (FRONTMATTER_REORGANIZATION_REQUIRED.md)
  - type: field_cleanup
    description: Remove duplicate and legacy fields per reorganization requirements
    deprecated_fields:
      # DELETE - Should be structured array in relationships, not text
      - relationships.relatedMaterials
      # DELETE - Duplicate of components.micro (when it appears at root level)
      - micro  # Only if components.micro exists
      # DELETE - Empty/unused arrays
      - related_materials
      # DELETE - General cleanup for reorganization
      - characteristics  # Legacy section - superseded by properties
      # NOTE: pageDescription REMOVED from deprecated_fields (Jan 14, 2026) - Now used for SEO
      - excerpt         # Not consumed by MaterialsLayout
      - section_description  # Not consumed by MaterialsLayout (Jan 15, 2026)
      - page_description     # Legacy snake_case duplicate - canonical is pageDescription
      - technicalSpecifications  # Not referenced anywhere
      - chemicalProperties       # Not referenced anywhere
      - safetyGuidelines        # Not referenced anywhere
      - dataValidation          # Not displayed to users
      - generatedDate           # Not displayed to users
      - lastModified            # Not displayed to users
      # DELETE - Legacy descriptive fields (replaced by structured properties)
      - materialCharacteristics_description
      - laserMaterialInteraction_description
      - micro_before_after      # Not consumed by MaterialsLayout (Jan 15, 2026)
      # faq REMOVED from deprecated list (Jan 15, 2026) - Structured FAQ format IS consumed
      - properties.materialCharacteristics.description
      - properties.laserMaterialInteraction.description
      - relationships.relatedMaterials  # Legacy text field
      - _distinctive_materialCharacteristics_description  # Legacy distinctiveness data
      # NOTE: components.micro REMOVED from deprecated_fields (Jan 14, 2026)
      # Content now properly structured with before/after descriptions
      # DELETE - Root-level property sections (should be nested under properties:)
      - materialCharacteristics
      - laserMaterialInteraction
      # DELETE - Legacy unstructured sections (Jan 15, 2026)
      - contaminatedBy     # Flat format not consumed (structured version in relationships used)
      - relatedMaterials   # Flat format not consumed (structured version in relationships used)
  # Export-time metadata ONLY (dateModified timestamp, pageTitle for frontend)
  - type: export_metadata
    description: Add ONLY export-time fields (dateModified, pageTitle if missing)
  - type: text_field_normalization
    description: Normalize text wrapper artifacts in description fields
    fields:
      - page_description
      - pageDescription
  # Hydrate authorId -> full author object from Authors.yaml
  - type: author_linkage
    description: Expand authorId to full author object for frontend compatibility
    author_id_field: authorId
    remove_author_id: false
  # Flatten nested properties to root level (preserves _section metadata)
  - type: flatten_properties
    description: Move properties.materialCharacteristics → materialCharacteristics (with _section)
    source_sections:
    - source: properties.materialCharacteristics
      target: materialCharacteristics
    - source: properties.laserMaterialInteraction
      target: laserMaterialInteraction
  # Add _section metadata to all sections that need it
  - type: section_metadata
    description: Add _section metadata with sectionTitle and sectionDescription to all sections
    config_file: data/schemas/section_display_schema.yaml
  # TRANSFORM-ONLY tasks
  - type: camelcase_normalization
    description: Convert snake_case → camelCase for software metadata fields (legacy data only)
  - type: field_ordering
    domain: materials
    description: Organize output structure
  # normalize_expert_answers removed (Jan 5, 2026) - FAQ → expert_answers conversion
  # must happen during source data generation, not at export time (Core Principle 0.6)
- type: field_order
  module: export.generation.field_order_generator
  class: FieldOrderGenerator
  domain: materials
  description: Normalize field order for consistency (must run last)
# Enrichers deprecated - all functionality moved to generators above
